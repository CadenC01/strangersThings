(this["webpackJsonpUNIV.Lab.ReactRouter"]=this["webpackJsonpUNIV.Lab.ReactRouter"]||[]).push([[0],{33:function(e,t,n){"use strict";n.r(t);var s=n(1),r=n(20),c=n.n(r),a=n(12),o=n(3),i=n.n(o),u=n(9),j=n(4),l=n(11),d=n(2),h=n(0),p=function(e){var t=e.user;return Object(h.jsxs)("div",{id:"home",children:[Object(h.jsx)("h1",{children:"Take a look at stranger's things!"}),t?Object(h.jsxs)("h1",{children:["Hi ",t.username]}):Object(h.jsx)("h1",{children:"Please Login/Register"})]})},b=function(e){var t=e.posts,n=e.token,r=Object(s.useState)(""),c=Object(j.a)(r,2),a=c[0],o=c[1],l=function(){var e=Object(u.a)(i.a.mark((function e(t,s){var r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("".concat(g,"/posts/").concat(s,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({message:{content:a}})});case 3:return r=e.sent,e.next=6,r.json();case 6:c=e.sent,console.log(c);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"posts",children:Object(h.jsx)("div",{id:"columnp",children:t.map((function(e){return Object(h.jsxs)("div",{id:"postss",children:[Object(h.jsx)("h1",{className:"post-title",children:e.title}),Object(h.jsx)("p",{className:"post-desc",children:e.description}),Object(h.jsx)("p",{className:"post-desc",children:e.price}),n?Object(h.jsxs)("form",{onSubmit:function(t){return l(t,e._id)},children:[Object(h.jsx)("input",{required:!0,minLength:4,placeholder:"Enter Message",value:a,onChange:function(e){return o(e.target.value)}}),Object(h.jsx)("button",{type:"submit",children:"Send"})]}):null]},e._id)}))})})},O=n(10),f=function(e){var t=e.setToken,n=Object(O.useState)(""),s=Object(j.a)(n,2),r=s[0],c=s[1],o=Object(O.useState)(""),l=Object(j.a)(o,2),d=l[0],p=l[1],b=Object(a.useHistory)(),f=function(){var e=Object(u.a)(i.a.mark((function e(n){var s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,fetch("".concat(g,"/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:r,password:d}})});case 3:return s=e.sent,e.next=6,s.json();case 6:c=e.sent,t(c.data.token),localStorage.setItem("token",c.data.token),b.push("/");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"register",children:Object(h.jsxs)("form",{className:"form",onSubmit:f,children:[Object(h.jsx)("input",{required:!0,minLength:4,placeholder:"Enter Username",value:r,onChange:function(e){return c(e.target.value)}}),Object(h.jsx)("input",{required:!0,minLength:4,placeholder:"Enter Password",value:d,onChange:function(e){return p(e.target.value)}}),Object(h.jsx)("button",{type:"submit",children:"Login"})]})})},x=function(e){var t=e.setToken,n=Object(O.useState)(""),s=Object(j.a)(n,2),r=s[0],c=s[1],o=Object(O.useState)(""),d=Object(j.a)(o,2),p=d[0],b=d[1],f=Object(O.useState)(""),x=Object(j.a)(f,2),m=x[0],v=x[1],k=Object(O.useState)(""),S=Object(j.a)(k,2),y=S[0],N=S[1],w=Object(a.useHistory)(),T=function(){var e=Object(u.a)(i.a.mark((function e(n){var s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),N(""),p===m){e.next=5;break}return N("Passwords do not match"),e.abrupt("return");case 5:return e.next=7,fetch("".concat(g,"/users/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:r,password:p}})});case 7:return s=e.sent,e.next=10,s.json();case 10:c=e.sent,console.log(c),c.error&&N(c.error.message),t(c.data.token),localStorage.setItem("token",c.data.token),w.push("/");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("div",{className:"register",children:[Object(h.jsxs)("p",{children:["If you already have an account ",Object(h.jsx)(l.a,{to:"/Login",children:"login"})]}),Object(h.jsx)("p",{className:"err-msg",children:y}),Object(h.jsxs)("form",{className:"form",onSubmit:T,children:[Object(h.jsx)("input",{required:!0,minLength:4,placeholder:"Enter Username",value:r,onChange:function(e){return c(e.target.value)}}),Object(h.jsx)("input",{required:!0,minLength:4,placeholder:"Enter Password",value:p,onChange:function(e){return b(e.target.value)}}),Object(h.jsx)("input",{required:!0,placeholder:"Confirm Password",value:m,onChange:function(e){return v(e.target.value)}}),Object(h.jsx)("button",{type:"submit",children:"Register"})]}),Object(h.jsx)("p",{className:"err-msg",children:y})]})},m=function(e){var t=e.posts,n=e.token,r=e.user,c=e.fetchposts,a=r.messages,o=Object(s.useState)(""),l=Object(j.a)(o,2),d=l[0],p=l[1],b=Object(s.useState)(""),O=Object(j.a)(b,2),f=O[0],x=O[1],m=Object(s.useState)(""),v=Object(j.a)(m,2),k=v[0],S=v[1],y=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log("clcs"),e.next=4,fetch("".concat(g,"/posts"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({post:{title:d,description:f,price:k}})});case 4:return e.next=6,c();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return console.log(a),Object(s.useEffect)((function(){}),[]),Object(h.jsxs)("div",{id:"Profile",children:[Object(h.jsxs)("form",{className:"form",onSubmit:y,children:[Object(h.jsx)("input",{required:!0,placeholder:"Enter Title",value:d,onChange:function(e){return p(e.target.value)}}),Object(h.jsx)("input",{required:!0,placeholder:"Enter Desctiption",value:f,onChange:function(e){return x(e.target.value)}}),Object(h.jsx)("input",{required:!0,placeholder:"Enter Price",value:k,onChange:function(e){return S(e.target.value)}}),Object(h.jsx)("button",{type:"submit",children:"Submit New Post"})]}),Object(h.jsx)("div",{children:t.map((function(e){if(e.isAuthor)return Object(h.jsxs)("div",{id:"postss",children:[Object(h.jsx)("h1",{className:"post-title",children:e.title}),Object(h.jsx)("p",{className:"post-desc",children:e.description}),Object(h.jsx)("p",{className:"post-desc",children:e.price}),Object(h.jsx)("button",{type:"button",onClick:function(){return function(e){console.log("DELETEDs"),fetch("".concat(g,"/posts/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}})}(e._id)},children:"Delete Post"})]},e._id)}))}),Object(h.jsxs)("div",{className:"msgs",children:[Object(h.jsx)("h1",{children:"Messages:"}),a.map((function(e){return console.log(e.fromUser.username),Object(h.jsxs)("div",{children:[Object(h.jsx)("p",{children:e.content}),Object(h.jsxs)("p",{children:["From: ",e.fromUser.username]})]},e._id)}))]})]})},g="https://strangers-things.herokuapp.com/api/2110-FTB-ET-WEB-PT/",v=function(e){var t=Object(s.useState)([]),n=Object(j.a)(t,2),r=n[0],c=n[1],a=Object(s.useState)(""),o=Object(j.a)(a,2),O=o[0],v=o[1],k=Object(s.useState)({}),S=Object(j.a)(k,2),y=S[0],N=S[1],w=Object(s.useState)([]),T=Object(j.a)(w,2),P=(T[0],T[1],function(){var e=Object(u.a)(i.a.mark((function e(){var t,n,s,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("token")){e.next=10;break}return e.next=3,fetch(g+"posts",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,c(n.data.posts),e.next=17;break;case 10:return e.next=12,fetch(g+"posts");case 12:return s=e.sent,e.next=15,s.json();case 15:r=e.sent,c(r.data.posts);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),E=function(){var e=Object(u.a)(i.a.mark((function e(){var t,n,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=localStorage.getItem("token"))&&v(t),e.next=4,fetch("".concat(g,"/users/me"),{headers:{Authorization:"Bearer ".concat(t)}});case 4:return n=e.sent,e.next=7,n.json();case 7:(s=e.sent).success,N(s.data);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){E(),P()}),[O]),Object(h.jsxs)("div",{id:"container",children:[Object(h.jsxs)("div",{id:"navbar",children:[Object(h.jsx)("h1",{children:"Stranger's Things"}),Object(h.jsx)(l.a,{className:"nav-link",to:"/",children:"Home"}),Object(h.jsx)(l.a,{className:"nav-link",to:"/Posts",children:"Posts"}),O?null:Object(h.jsx)(l.a,{className:"nav-link",to:"/Register",children:"Login/Register"}),O?Object(h.jsx)(l.a,{className:"nav-link",to:"/Profile",children:"Profile"}):null,O?Object(h.jsx)(l.a,{className:"nav-link",to:"/",onClick:function(){v(""),N({}),localStorage.removeItem("token")},children:"Log out"}):null]}),Object(h.jsxs)("div",{id:"main-section",children:[Object(h.jsx)(d.Route,{exact:!0,path:"/",children:Object(h.jsx)(p,{user:y})}),Object(h.jsx)(d.Route,{exact:!0,path:"/Posts",children:Object(h.jsx)(b,{posts:r,token:O})}),Object(h.jsx)(d.Route,{exact:!0,path:"/Register",children:Object(h.jsx)(x,{setToken:v})}),Object(h.jsx)(d.Route,{exact:!0,path:"/Login",children:Object(h.jsx)(f,{setToken:v})}),Object(h.jsx)(d.Route,{exact:!0,path:"/Profile",children:Object(h.jsx)(m,{token:O,posts:r,fetchposts:P,user:y})})]})]})},k=document.getElementById("app");c.a.render(Object(h.jsx)(a.BrowserRouter,{children:Object(h.jsx)(v,{})}),k)}},[[33,1,2]]]);
//# sourceMappingURL=main.d9998934.chunk.js.map